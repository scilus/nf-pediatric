Changes in component 'nf-neuro/bundle/labelmap'
'modules/nf-neuro/bundle/labelmap/environment.yml' is unchanged
'modules/nf-neuro/bundle/labelmap/meta.yml' is unchanged
Changes in 'bundle/labelmap/main.nf':
--- modules/nf-neuro/bundle/labelmap/main.nf
+++ modules/nf-neuro/bundle/labelmap/main.nf
@@ -2,9 +2,7 @@
     tag "$meta.id"
     label 'process_single'
 
-    container "${ workflow.containerEngine == 'singularity' && !task.ext.singularity_pull_docker_container ?
-        'https://scil.usherbrooke.ca/containers/scilus_2.0.2.sif':
-        'scilus/scilus:2.0.2' }"
+    container 'scilus/scilus:2.0.2'
 
     input:
         tuple val(meta), path(bundles), path(centroids)
@@ -30,8 +28,11 @@
     centroids=(${centroids.join(" ")})
 
     for index in \${!bundles[@]};
-        do ext=\${bundles[index]#*.}
-        bname=\$(basename \${bundles[index]} .\${ext})
+        do
+        ext=\${bundles[index]#*.}
+        pos=\$((\$(echo \${bundles[index]} | grep -b -o __ | cut -d: -f1)+2))
+        bname=\${bundles[index]:\$pos}
+        bname=\$(basename \${bname} .\${ext})
 
         scil_bundle_label_map.py \${bundles[index]} \${centroids[index]} \
             tmp_out $nb_points $colormap $new_labelling -f
@@ -53,9 +54,15 @@
     """
     scil_bundle_label_map.py -h
 
+    bundles=(${bundles.join(" ")})
+    centroids=(${centroids.join(" ")})
+
     for index in \${!bundles[@]};
-        do ext=\${bundles[index]#*.}
-        bname=\$(basename \${bundles[index]} .\${ext})
+        do
+        ext=\${bundles[index]#*.}
+        pos=\$((\$(echo \${bundles[index]} | grep -b -o __ | cut -d: -f1)+2))
+        bname=\${bundles[index]:\$pos}
+        bname=\$(basename \${bname} .\${ext})
 
         touch ${prefix}__\${bname}_labels.nii.gz
         touch ${prefix}__\${bname}_labels.trk

'modules/nf-neuro/bundle/labelmap/tests/main.nf.test.snap' is unchanged
'modules/nf-neuro/bundle/labelmap/tests/tags.yml' is unchanged
'modules/nf-neuro/bundle/labelmap/tests/nextflow.config' is unchanged
'modules/nf-neuro/bundle/labelmap/tests/main.nf.test' is unchanged
************************************************************

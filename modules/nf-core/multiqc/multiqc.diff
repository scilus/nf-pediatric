Changes in component 'nf-core/multiqc'
Changes in 'multiqc/environment.yml':
--- modules/nf-core/multiqc/environment.yml
+++ modules/nf-core/multiqc/environment.yml
@@ -2,4 +2,4 @@
   - conda-forge
   - bioconda
 dependencies:
-  - bioconda::multiqc=1.25.1
+  - bioconda::multiqc=1.27

'modules/nf-core/multiqc/meta.yml' is unchanged
Changes in 'multiqc/main.nf':
--- modules/nf-core/multiqc/main.nf
+++ modules/nf-core/multiqc/main.nf
@@ -1,13 +1,12 @@
 process MULTIQC {
+    tag "$meta.id"
     label 'process_single'
 
-    conda "${moduleDir}/environment.yml"
-    container "${ workflow.containerEngine == 'singularity' && !task.ext.singularity_pull_docker_container ?
-        'https://depot.galaxyproject.org/singularity/multiqc:1.25.1--pyhdfd78af_0' :
-        'biocontainers/multiqc:1.25.1--pyhdfd78af_0' }"
+    container "${ 'multiqc/multiqc:v1.28' }"
 
     input:
-    path  multiqc_files, stageAs: "?/*"
+    tuple val(meta), path(qc_images)
+    path  multiqc_files
     path(multiqc_config)
     path(extra_multiqc_config)
     path(multiqc_logo)
@@ -15,7 +14,7 @@
     path(sample_names)
 
     output:
-    path "*multiqc_report.html", emit: report
+    path "*.html"              , emit: report
     path "*_data"              , emit: data
     path "*_plots"             , optional:true, emit: plots
     path "versions.yml"        , emit: versions
@@ -25,23 +24,43 @@
 
     script:
     def args = task.ext.args ?: ''
-    def prefix = task.ext.prefix ? "--filename ${task.ext.prefix}.html" : ''
+    def prefix = "${meta.id}"
     def config = multiqc_config ? "--config $multiqc_config" : ''
     def extra_config = extra_multiqc_config ? "--config $extra_multiqc_config" : ''
     def logo = multiqc_logo ? "--cl-config 'custom_logo: \"${multiqc_logo}\"'" : ''
     def replace = replace_names ? "--replace-names ${replace_names}" : ''
     def samples = sample_names ? "--sample-names ${sample_names}" : ''
     """
-    multiqc \\
-        --force \\
-        $args \\
-        $config \\
-        $prefix \\
-        $extra_config \\
-        $logo \\
-        $replace \\
-        $samples \\
-        .
+    # Process SC txt files if they exist
+    if ls *__sc.txt 1> /dev/null 2>&1; then
+        echo -e "Sample Name,SC_Value" > sc_values.csv
+        for sc in *__sc.txt; do
+            sample_name=\$(basename \$sc __sc.txt)
+            sc_value=\$(cat \$sc)
+            echo -e "\${sample_name},\${sc_value}" >> sc_values.csv
+        done
+    fi
+
+    # Process Dice score txt files if they exist
+    if ls *__dice.txt 1> /dev/null 2>&1; then
+        echo -e "Sample Name,Dice_Score" > dice_values.csv
+        for dice in *__dice.txt; do
+            sample_name=\$(basename \$dice __dice.txt)
+            dice_value=\$(cat \$dice)
+            echo -e "\${sample_name},\${dice_value}" >> dice_values.csv
+        done
+    fi
+
+    multiqc . -v \
+        --force \
+        $args \
+        $config \
+        --filename ${prefix}.html \
+        $extra_config \
+        $logo \
+        $replace \
+        $samples \
+        --comment "This report contains QC images for subject ${prefix}"
 
     cat <<-END_VERSIONS > versions.yml
     "${task.process}":
@@ -50,14 +69,15 @@
     """
 
     stub:
+    def prefix = "${meta.id}"
     """
-    mkdir multiqc_data
-    mkdir multiqc_plots
-    touch multiqc_report.html
+    mkdir ${prefix}_multiqc_data
+    mkdir ${prefix}_multiqc_plots
+    touch ${prefix}_multiqc_report.html
 
     cat <<-END_VERSIONS > versions.yml
     "${task.process}":
         multiqc: \$( multiqc --version | sed -e "s/multiqc, version //g" )
     END_VERSIONS
     """
-}
+}
Changes in 'multiqc/tests/main.nf.test.snap':
--- modules/nf-core/multiqc/tests/main.nf.test.snap
+++ modules/nf-core/multiqc/tests/main.nf.test.snap
@@ -2,14 +2,14 @@
     "multiqc_versions_single": {
         "content": [
             [
-                "versions.yml:md5,41f391dcedce7f93ca188f3a3ffa0916"
+                "versions.yml:md5,8f3b8c1cec5388cf2708be948c9fa42f"
             ]
         ],
         "meta": {
-            "nf-test": "0.9.0",
-            "nextflow": "24.04.4"
+            "nf-test": "0.9.2",
+            "nextflow": "24.10.4"
         },
-        "timestamp": "2024-10-02T17:51:46.317523"
+        "timestamp": "2025-01-27T09:29:57.631982377"
     },
     "multiqc_stub": {
         "content": [
@@ -17,25 +17,25 @@
                 "multiqc_report.html",
                 "multiqc_data",
                 "multiqc_plots",
-                "versions.yml:md5,41f391dcedce7f93ca188f3a3ffa0916"
+                "versions.yml:md5,8f3b8c1cec5388cf2708be948c9fa42f"
             ]
         ],
         "meta": {
-            "nf-test": "0.9.0",
-            "nextflow": "24.04.4"
+            "nf-test": "0.9.2",
+            "nextflow": "24.10.4"
         },
-        "timestamp": "2024-10-02T17:52:20.680978"
+        "timestamp": "2025-01-27T09:30:34.743726958"
     },
     "multiqc_versions_config": {
         "content": [
             [
-                "versions.yml:md5,41f391dcedce7f93ca188f3a3ffa0916"
+                "versions.yml:md5,8f3b8c1cec5388cf2708be948c9fa42f"
             ]
         ],
         "meta": {
-            "nf-test": "0.9.0",
-            "nextflow": "24.04.4"
+            "nf-test": "0.9.2",
+            "nextflow": "24.10.4"
         },
-        "timestamp": "2024-10-02T17:52:09.185842"
+        "timestamp": "2025-01-27T09:30:21.44383553"
     }
 }
'modules/nf-core/multiqc/tests/tags.yml' is unchanged
'modules/nf-core/multiqc/tests/nextflow.config' is unchanged
'modules/nf-core/multiqc/tests/main.nf.test' is unchanged
************************************************************
